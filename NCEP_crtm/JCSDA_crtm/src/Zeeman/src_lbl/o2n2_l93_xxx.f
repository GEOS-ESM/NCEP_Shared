      subroutine O2N2_xxx (pkb,v,ekb,frq,npp,ncpp)
  
c ...................................................................
c     Computes molecular oxygen line absorption (n"=npp) and dry air continuum
c     absorption (ncpp). Equations were taken from pmp93 model.
c          -- Yong Han, 1993
c
c     inputs:  pkb    = pressure (kPa)
c              v      = 300./T   (T in kelvins)
c              ekb    = water vapor partial pressure (kPa)
c              frq    = frequency (GHz)
c
c     outputs: npp  = n"= molecular oxygen line absorption
c              ncpp = dry air continuum absorption
c
c ...................................................................
  

c	... force all variables to be declared ...
 	implicit none

c	... argument list variables ...
         real p, pkb, v, e, ekb, frq, npp, ncpp

c	... local variables ...
	real f0o2(44), a(6,44), s, gamma, delta, so, gammao, sn,
     +       f
	integer i, j
        complex zn,zf,zfo, zfn


c	... data statements ...
      data f0o2/
     +        50.474239,  50.987747,  51.503349,  52.021412,  52.542393,
     +        53.066906,  53.595749,  54.130001,  54.671158,  55.221367,
     +        55.783802,  56.264774,  56.363388,  56.968204,  57.612484,
     +        58.323875,  58.446590,  59.164207,  59.590984,  60.306061,
     +        60.434776,  61.150558,  61.800156,  62.411217,  62.486259,
     +        62.997978,  63.568520,  64.127769,  64.678902,  65.224068,
     +        65.764771,  66.302094,  66.836830,  67.369598,  67.900864,
     +        68.431007,  68.960312, 118.750343, 368.498352, 424.763123,
     +       487.249359, 715.393127, 773.839661, 834.145325/
      data ((a(i,j),i=1,6),j=1,44)/
     +          0.09400,  9.694,  0.890,  0.000,  0.240,  0.790,
     +          0.24600,  8.694,  0.910,  0.000,  0.220,  0.780,
     +          0.60800,  7.744,  0.940,  0.000,  0.197,  0.774,
     +          1.41400,  6.844,  0.970,  0.000,  0.166,  0.764,
     +          3.10200,  6.004,  0.990,  0.000,  0.136,  0.751,
     +          6.41000,  5.224,  1.020,  0.000,  0.131,  0.714,
     +         12.47000,  4.484,  1.050,  0.000,  0.230,  0.584,
     +         22.80000,  3.814,  1.070,  0.000,  0.335,  0.431,
     +         39.18000,  3.194,  1.100,  0.000,  0.374,  0.305,
     +         63.16000,  2.624,  1.130,  0.000,  0.258,  0.339,
     +         95.35000,  2.119,  1.170,  0.000, -0.166,  0.705,
     +         54.89000,  0.015,  1.730,  0.000,  0.390, -0.113,
     +        134.39999,  1.660,  1.200,  0.000, -0.297,  0.753,
     +        176.30000,  1.260,  1.240,  0.000, -0.416,  0.742,
     +        214.10001,  0.915,  1.280,  0.000, -0.613,  0.697,
     +        238.60001,  0.626,  1.330,  0.000, -0.205,  0.051,
     +        145.70000,  0.084,  1.520,  0.000,  0.748, -0.146,
     +        240.39999,  0.391,  1.390,  0.000, -0.722,  0.266,
     +        211.20000,  0.212,  1.430,  0.000,  0.765, -0.090,
     +        212.39999,  0.212,  1.450,  0.000, -0.705,  0.081,
     +        246.10001,  0.391,  1.360,  0.000,  0.697, -0.324,
     +        250.39999,  0.626,  1.310,  0.000,  0.104, -0.067,
     +        229.80000,  0.915,  1.270,  0.000,  0.570, -0.761,
     +        193.30000,  1.260,  1.230,  0.000,  0.360, -0.777,
     +        151.70000,  0.083,  1.540,  0.000, -0.498,  0.097,
     +        150.30000,  1.665,  1.200,  0.000,  0.239, -0.768,
     +        108.70000,  2.115,  1.170,  0.000,  0.108, -0.706,
     +         73.35000,  2.620,  1.130,  0.000, -0.311, -0.332,
     +         46.35000,  3.195,  1.100,  0.000, -0.421, -0.298,
     +         27.48000,  3.815,  1.070,  0.000, -0.375, -0.423,
     +         15.30000,  4.485,  1.050,  0.000, -0.267, -0.575,
     +          8.00900,  5.225,  1.020,  0.000, -0.168, -0.700,
     +          3.94600,  6.005,  0.990,  0.000, -0.169, -0.735,
     +          1.83200,  6.845,  0.970,  0.000, -0.200, -0.744,
     +          0.80100,  7.745,  0.940,  0.000, -0.228, -0.753,
     +          0.33000,  8.695,  0.920,  0.000, -0.240, -0.760,
     +          0.12800,  9.695,  0.900,  0.000, -0.250, -0.765,
     +         94.50000,  0.009,  1.630,  0.000, -0.036,  0.009,
     +          6.79000,  0.049,  1.920,  0.600,  0.000,  0.000,
     +         63.80000,  0.044,  1.930,  0.600,  0.000,  0.000,
     +         23.50000,  0.049,  1.920,  0.600,  0.000,  0.000,
     +          9.96000,  0.145,  1.810,  0.600,  0.000,  0.000,
     +         67.10000,  0.130,  1.820,  0.600,  0.000,  0.000,
     +         18.00000,  0.147,  1.810,  0.600,  0.000,  0.000/
c Imaginary part of ZN is the line absorption (np) and the real
c part of ZN is the dispersive delay (not used here)
C   OXYGEN line absorption
       ZN=CMPLX(0.,0.)
       F=frq
       p=pkb*10.
       e=ekb*10.
       DO 10 I=1,44
        GAMMA=0.
        S=A(1,I)*P*V**3*EXP(A(2,I)*(1.-V))*1.E-6
        GAMMA=A(3,I)*(P*V**(0.8-A(4,I))+1.1*E*V)*1.E-3
        GAMMA=(GAMMA**2+(25*0.6E-4)**2)**0.5
        DELTA=(A(5,I)+A(6,I)*V)*(P+E)*(V**0.8)*1.E-3
        ZF=F/F0O2(I)*(CMPLX(1.,-DELTA)/CMPLX(F0O2(I)-F,-GAMMA)-
     +               CMPLX(1.,DELTA)/CMPLX(F0O2(I)+F,GAMMA))
        ZN=ZN+S*ZF
10     CONTINUE
       npp=AIMAG(ZN)
       if(npp .lt. 0.)npp=0.
C
C   DRY AIR CONTINUUM
      ZN=CMPLX(0.,0.)
      So=6.14E-5*P*V**2
      GAMMAo=0.56E-3*(P+E)*V**.8
      ZFo=-F/CMPLX(F,GAMMAo)
      Sn=1.40E-12*p**2*V**3.5
      ZFn=CMPLX(0.,F/(1.93E-5*F**1.5+1.))
      ZN=So*ZFo+Sn*ZFn
      ncpp=AIMAG(ZN)
  
      return
      end 
